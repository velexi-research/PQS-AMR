c***********************************************************************
c
c kernels_2d.f
c
c F77 routines for unit tests of 2D lsm functions
c
c***********************************************************************

c***********************************************************************
c
c Compute signed distance function for circle of specified radius
c centered at the origin.
c
c Parameters
c ----------
c phi: [output] signed distance function
c
c x_lo: array containing lower corner of grid
c
c dx: array containing grid spacing in each coordinate direction
c
c r: radius of circle
c
c *_gb_lo: lower corner of index range for ghostbox
c
c *_gb_hi: upper corner of index range for ghostbox
c
c ib_lo: lower corner of index range for interior box
c
c ib_hi: upper corner of index range for interior box
c
c***********************************************************************
      subroutine setPhiCircle(
     &  phi,
     &  phi_gb_lo, phi_gb_hi,
     &  ib_lo, ib_hi,
     &  x_lo,
     &  dx,
     &  r)
***********************************************************************
c { begin subroutine
      implicit none

      integer phi_gb_lo(1:2), phi_gb_hi(1:2)
      @REAL@ phi(phi_gb_lo(1):phi_gb_hi(1),
     &           phi_gb_lo(2):phi_gb_hi(2))

      integer ib_lo(1:2), ib_hi(1:2)
      real*8 x_lo(1:2)
      real*8 dx(1:2)
      real*8 r

      integer i, j
      real x, y

c     loop over interior cells {
      do j=ib_lo(2),ib_hi(2)
        do i=ib_lo(1),ib_hi(1)

          x = x_lo(1) + (i - ib_lo(1) + 0.5) * dx(1)
          y = x_lo(2) + (j - ib_lo(2) + 0.5) * dx(2)

          phi(i,j) = sqrt(x**2 + y**2) - r

        enddo
      enddo
c     } end loop over interior cells

      return
      end
c } end subroutine
